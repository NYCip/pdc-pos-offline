[tool:pytest]
# Pytest-Odoo configuration for pdc-pos-offline module
# Wave 3 Phase B.1: Test Infrastructure Setup
# Purpose: Configure test discovery and execution for offline sync system

# Test discovery patterns
# Find test files in tests/ directory matching test_*.py pattern
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Test markers for Offline Sync system
# Usage: pytest -m "offline" to run only offline-related tests
markers =
    offline: Offline mode tests
    sync: Data synchronization tests
    persistence: Database persistence tests
    security: Security and PIN tests
    backend: Backend API tests
    login: Login and authentication tests
    memory: Memory leak and performance tests
    field_sync: Field synchronization tests
    unit: Unit tests (fast, isolated)
    integration: Integration tests (multi-model)
    e2e: End-to-end tests (full workflows)
    slow: Tests that take significant time (deselect with '-m "not slow"')
    at_install: Run test during module installation
    post_install: Run after module installation

# Output and reporting options
addopts =
    -v
    --strict-markers
    --tb=short
    --color=yes
    --code-highlight=yes

# Coverage configuration (75% target - already high from E2E)
# Run with: pytest --cov=pdc_pos_offline --cov-report=html --cov-report=term-missing

# Logging configuration
# Debug level essential for offline sync troubleshooting
log_cli = true
log_cli_level = DEBUG
log_cli_format = %(asctime)s [%(levelname)s] %(name)s - %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Capture settings - don't capture for debugging offline/sync issues
log_cli_handler_level = DEBUG

# Warnings
filterwarnings =
    ignore::DeprecationWarning
    ignore::UserWarning

# Minimum Python version
minversion = 3.8

# Timeout for tests (seconds) - may need adjustment for sync tests
timeout = 300

# Odoo-specific settings
odoo_config_file = odoo.conf

# Parallel execution (use -n auto for automatic)
# Note: Offline tests may have dependencies; test serially first
# Requires: pip install pytest-xdist
# addopts = -n auto
